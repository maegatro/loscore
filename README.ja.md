# 事前課題: LoScore

## Objectives - 達成目標

この単元を通して習得すること：

- 🧠 アキュームレータの問題を解けるようになる
- ➰ インデックスを使って配列の各要素にループでアクセスする
- ✅ Jasmine のテストをパスするためにコードを書く
- ⌨️ 引数として関数を受け取る関数を書く
- ➡️ 関数に対してコールバックを渡す
- 👉 ハッシュマップに値を蓄積する
- 👈 ハッシュマップから値を取り出す
- 👍 オブジェクトのプロパティにアクセスするために括弧記号を使う

またコミットを作成する習慣を今のうちに作りましょう。ワークフローの説明にはコミットを作ることのリマインダーも含んでいますが、_近いうちそのリマインダーはなくなります。_

**上記でこの単元での習得内容について触れていますが、この項目ごとでしかコミットを作ってはいけないのではなく、それ以上にコミット 💬💬💬 を作成しても構いません。**この項目どおりにコミットを作ったとしても評価されるわけでもありません。日頃から多くのコミットを作成するようにしましょう。それがベストプラクティスです。

コミットの順番も項目どおりにする必要はありません。ただしあるメソッドが他のメソッドに依存している場合は、依存先のメソッドを先に作成する必要があります。もしはまってしまった場合はとばして、後で戻ってくるのももちろんありです！

そしてもし混乱して助けが必要な場合、あるいはより深く知りたくて情報がほしいという場合には、#stackoverflow チャンネルか事前課題の AMA のときに質問してください。

## Tutorial - チュートリアル

[Underscore.js](http://underscorejs.org/) と [Lodash](https://lodash.com/) は JavaScript のライブラリ 📚 です。ライブラリとはあなたのコードを単純化するためにメソッドを提供してくれるものです。ここではそれを活用するのではなく、それらをあなたの手で最初から作ってみるという練習をやってもらいます！

この 2 つのライブラリは `_` という名前の変数に格納されます。

> 🦋 **注記：** 変数にアンダースコアの名前をつけるのは、[一般的に避けるべきです](https://javascript.info/ninja-code)。ただし、Underscore.js は特殊な環境下で動かすため、そのスタイルをそのまま採用しています。

この宿題では、自分で作る `_` というオブジェクトに Underscore や Lodash ライブラリにあるメソッドを自分の手で実装することにより、JavaScript のスキルを実現してもらいます。

もしこれらのメソッドをどう書けばよいか理解できたら、どのように使えるかも理解できるでしょう！

### Window

`Window` というグローバルオブジェクトがあります。これはブラウザで自動的に定義されているもので、たくさんのメンバーを持っています。JavaScript では、`var` を使ってグローバル変数を宣言すると `window` オブジェクトの中では若干ハンドリングが難しい動きをします。そのグローバル変数は `window` ではひそかに一つのメンバーとなってしまうのです。

console を開いて試してみましょう。`var x = 42;` とタイプしてみましょう。そして `window.x` とタイプして何が起こるかチェックしてみてください。ちゃんと表示されるでしょう？しかしこれと同じことを `let` や `const` で試してみると、数値は表示されません。なぜかというと ES6 ができるだけこういったことを制御してくれるからです。

`(()=>{...})();` もグローバル変数をコントロールするために使えます。以下のように window オブジェクトに特別なグローバル変数を割り当てることもできます。

`window.someObject = {};`

`loscore.js` のファイルでは、以下のようにして `window` オブジェクトに `_` という名前のオブジェクトを追加します。

`window._ = {};`

## Basic Requirements - 基礎レベル

### Basics - 基礎

- [ ] このリポジトリをフォークしてクローンしてください。

- [ ] `testrunner.html` をブラウザで開き、テストのリストが表示されてほとんどが失敗していることを確認してください。😅

- [ ] `src/loscore.js` の中にある関数宣言を埋めて、テストをパスするようにしてください。

- [ ] ファイルの上部をチェックしてください。`use strict` がどんな意味を持っていたでしょうか？もし覚えていなければ復習しましょう。

> 🦋 **注意：**関数宣言はすでに用意してあります。指示された場合を除き、関数宣言を編集する必要はありません。

- [ ] もし以下の設問が理解できなかった場合、もしくはそれぞれのメソッドが何をするべきかがわからなかった場合はライブラリのドキュメントを読んでみましょう。これらのメソッドは [Underscore](https://underscorejs.org) と [LoDash](https://lodash.com/) にあるものです。なにか調べたい場合はドキュメント 📄📄 を読み、console で使ってみましょう。

以下のメソッドを書いてください。

- [ ] `_.identity`: identity は受け取った最初の引数を返します。単純すぎてなんの役に立つのかわからないかもしれませんが、iteratee 関数を必要とする関数で使うことになります。もし iteratee 関数が引数として与えられなかったら、 `_.identity` が代わりに使われることになります。

- [ ] "Wrote identity method" というメッセージとともにコミットしてください。

- [ ] `_.add`: add は 2 つの引数を取ってそれらを足します。このメソッドは例としてすでに実装してあります。

#### Arrays - 配列

これらのメソッドを書いてください。

- [ ] `_.head`: head は配列の最初の要素を取って返します。このメソッドは例としてすでに実装してあります。

- [ ] `_.tail`: tail は配列の最初の要素を除いて返します。

- [ ] `_.take`: take は配列の最初の要素から n 個の要素をスライスして返します。

  ```js
  _.take([1, 2, 3]);
  // => [1]
  _.take([1, 2, 3], 2);
  // => [1, 2]
  _.take([1, 2, 3], 5);
  // => [1, 2, 3]
  _.take([1, 2, 3], 0);
  // => []
  ```

- [ ] `_.takeRight`: takeRight は配列の最後の要素から n 個の要素をスライスして返します。

  ```js
  _.takeRight([1, 2, 3]);
  // => [3]
  _.takeRight([1, 2, 3], 2);
  // => [2, 3]
  _.takeRight([1, 2, 3], 5);
  // => [1, 2, 3]
  _.takeRight([1, 2, 3], 0);
  // => []
  ```

- [ ] `_.uniq`: uniq は配列の要素から重複を排除して返します。

- [ ] 今までやったことを要約する適切なメッセージ 💬💬💬 とともにコミットを発行してください。

#### Collections - コレクション

JavaScript におけるコレクションは複数の値を持つ配列可オブジェクトになります。

以下のメソッドを書いてください。

- [ ] `_.size`: size は array-like な値、文字列の文字数やオブジェクトの要素数といったレングス 📏 を返すことによってコレクションのサイズを返します。

- [ ] `_.each`: size はコレクションの各要素に対して 'iteratee' を呼び出してください。'iteratee' はオブジェクトにも配列にも使うことができます。'iteratee' は値、キー（もしくはインデックス）とコレクション自体を受け取ります。戻り地はなく、配列のそれぞれの要素に対して与えられた関数を単純に実行するだけです。

> 🦋 **この "iteratee" とはなにか？** 今後より頻繁に見ることになります。iteratee とはコールバックの一種で、コレクションのそれぞれの要素に対して呼び出されるべきものです。lodash や underscore で典型的なのは iteratee が呼び出されたとき、値、キー（インデックス）とそのコレクション自体を引数として呼び出されます：`iteratee(value, key, collection)`

- [ ] `_.indexOf`: indexOf は配列の中でターゲットがどのインデックスに位置しているかを返します。

  - [ ] 👉💻 indexOf は `_.each` メソッドを使って実装してください。

- [ ] `_.map`: map は配列のすべての要素に対して、iteratee を値、キー（インデックス）とコレクションを引数として実行し、その結果を新しい配列に格納して返すものです。言い換えれば、map の結果である配列は iteratee の結果を含まなければならないということは、iteratee が結果をかえさなければならないとい返さなければならないということです。

  - [ ] 👉💻 map は `_.each` メソッドを使って実装してください。

- [ ] `_.filter`: filter は与えられたテストにパスした要素のみ新しい配列に格納して返します。テストが与えられなかった場合はすべての要素を返します。

  - [ ] 👉💻 filter は `_.each` メソッドを使って実装してください。
  - [ ]🤔 `_.filter` を書くのに `_.map` を使うべきではない理由は何でしょうか？ヒントは、ここでのコールバックは Boolean 型を返すことです。

- [ ] 今までやったことを要約する適切なメッセージ 💬💬💬 とともにコミットを発行してください。

- [ ] `_.reject`: reject はテストにパスしない配列の要素を返します。

  - [ ] 👉💻 `_.filter` を実装するときに使ってください。

- [ ] `_.pluck`: 実装するのに `_.map` を使っていることに注意してください。

  `_.pluck` 要素がオブジェクトである配列を引数として取り、あるプロパティにある値を配列に入れて返します。指定されたオブジェクトを 'pluck' して返すメソッドです。

  `_.map` は配列の値を新しい配列に移し替えたいときにとりわけ便利です。`_.map` を実装することで `_.pluck` のテストもパスするはずです。

- [ ] `_.pluck` を書き換えてビルトインのメソッドを使わず、ループを使うように変更してください。

> 🦋 **テストケースがネイティブメソッドをテストしてしまっているものはないでしょうか？**この宿題では、`map`, `indexOf`, `forEach`, `filter`, `reduce`, `every`, `some` や `includes` は使わず、自分の手で実装してください。まさにこれらをどのように実装するかがこの宿題の目的です 😂

- [ ] 今までやったことを要約する適切なメッセージ 💬💬💬 とともにコミットを発行してください。

- [ ] `_.reduce`: reduce は コレクションのそれぞれの要素に対して `iterator(accumulator, item)` を繰り返し実行することで、コレクションを一つの値に "reduce" - まとめるものです。アキュームレータは一回前のイテレータ呼び出しの結果になっていなければなりません。

  - [ ] もし初期値が渡されていなければ、コレクションの最初の値がアキュームレータとして使われます。

  ```js
  var numbers = [1, 2, 3];
  var accumulate = function(result, int) {
    return result + int;
  };
  var sum = _.reduce(numbers, accumulate, 0); // ---> 6
  ```

- [ ] `_.contains`: \_.contains は配列やオブジェクトにターゲットの値が存在するかを確かめます。'===' を使って存在確認をします。reduce を使ってこのメソッドをすでに実装してありますので、正しく reduce を作ることができていれば、テストはパスします。何が起こっているのかを確実に理解して次に進みましょう。

- [ ] `_.every`: every はコレクションの全ての要素に対して与えられたテストが通るかどうかを確かめます ✅。コールバックを引数として取り、Boolean 型を返すようにしましょう。

  - [ ] 👉💻 every は `_.reduce` を使って実装してください。

- [ ] 今までやったことを要約する適切なメッセージ 💬💬💬 とともにコミットを発行してください。

#### Objects - オブジェクト

以下のメソッドを書いてください。

- [ ] `_.extend`: extend は オブジェクトを別のオブジェクトで拡張するものです。最初のオブジェクトは基底となるオブジェクト、次の引数は拡張するのに使うオブジェクトです。このメソッドではシャローコピーを使ってください。

  - [ ] 👉💻 extend は `_.each` を使って実装してください。

- [ ] 今までやったことを要約する適切なメッセージ 💬💬💬 とともにコミットを発行してください。

#### Functions - 関数

これらは関数デコレータです。関数デコレータとは関数を引数として取り、処理の内容を少し変更した上で新しいバージョンの関数をアウトプットとして返します。

以下のメソッドを書いてください。

- [ ] `_.once`: once は一回しか使えない関数を返します。二回目以降は同じ値を返すようにします。

  - [ ] 👉💻 これを実装するためにはクロージャーを使います。

- [ ] `_.memoize`: memoize は引数として関数を取ります。インプットの関数の結果を記憶（キャッシュ）します。このメソッドが返す関数は、呼び出されたときに同じ引数で呼び出されたことがあるかをチェックしなければなりません。可能ならキャッシュした結果を返すようにします。引数に渡されるのはプリミティブな値と仮定してください。

  - [ ] 🤔🤔 `JSON.stringify` を使うことを考えても良いかもしれません。

- [ ] 今までやったことを要約する適切なメッセージ 💬💬💬 とともにコミットを発行してください。

- [ ] `_.invoke` : invoke はリストにあるそれぞれの値について、`functionOrKey`  として渡されたメソッドを呼び出します。それ以外の引数はないものとします。

  - [ ] `functionOrKey` は文字列にもなりえますし、関数自体にもなりえます。もし関数である場合は値をその関数に直接 apply する必要があります。
  - [ ] 👉💻 ここで `apply` を使いたいと考えるはずです。もしくは少なくとも[この内容を押さえて](http://lmgtfy.com/?q=apply+avascript)ください。

```js
_.invoke(
  [
    [5, 1, 7],
    [3, 2, 1]
  ],
  "sort"
);
// => [[1, 5, 7], [1, 2, 3]]
```

- [ ] Code Chrysalis git flow の指示に従って、`pull request` を作ってください。

## Advanced Requirements - 応用レベル

基礎レベル全てを完了したらこちらに取り組んでください。**こちらについてはテストも自分で作る必要があります。**応用レベルは任意ですが、トライすることを強くおすすめします。_ただし応用レベルに取り組む前に全ての事前課題を完了することにまずは集中してください。_

これらのメソッドは Underscore ライブラリ 📚 にあります。

- [ ] より多くの情報や例を見たい場合は、[Underscore](https://underscorejs.org) のドキュメント 📄📄 を見てください。

- [ ] 忘れずにコミット 💬💬💬 してくださいね。

以下のメソッドを作ってください。

- [ ] `_.sortBy`: sortBy は第一引数として渡されるコレクションをソートして返すもので、ソート結果は第二引数として渡される iteratee を実行した後の値に基づいて昇順で並べるものです。iteratee はソートするのに使うプロパティの名前を示す文字列でも良いです（たとえば 📏）。

- [ ] `_.zip`: zip は 2 つ以上の配列を、同じインデックスの要素を結合して一つの配列として返します。

- [ ] `_.delay`: delay は引数として与えられた数値をミリ秒換算して待機し、その後渡された関数を呼び出します。

- [ ] `_.defaults`: defaults は `_.extend` に似ていますが、すでに存在している key を上書きしません。

- [ ] `_.throttle`: throttle が返す関数は実行されると与えられた時間 ⌚ 内に一度だけ実行できるようにします。

## Documentation - ドキュメント

- [Underscore.js](http://underscorejs.org/)
- [Lodash](https://lodash.com/)
